اسکریپت سبک و سریع Tinc Mesh Tunnel

ساخت یک شبکه خصوصی بین سرورهای شما — بدون نیاز به پنل

این چیه؟

tinc-mesh.sh یک اسکریپت bash سبک است که:

سرورها را با استفاده از Tinc VPN به هم متصل می‌کند
به صورت خودکار یک تونل مش کامل (Full Mesh) ایجاد می‌کند
فقط به آی‌پی سرور + پسورد SSH نیاز دارد
همه چیز را روی سرورهای ریموت نصب و تنظیم می‌کند
نودها را همیشه سینک نگه می‌دارد

مناسب برای:

اتصال سرورهای ایران ↔ خارج
بک‌بون تونل ریورس
لایه انتقال برای V2Ray / Xray
مسیریابی بین چند لوکیشن

ویژگی‌ها

بدون نیاز به پنل
اضافه کردن نود با یک دستور
اختصاص خودکار آی‌پی داخلی
سینک کامل بین همه نودها
KeepAlive فعال
تنظیم MTU (بر روی 1380)
رفع مشکل PMTU و MSS
حذف کامل و تمیز نود
پسورد فقط پرسیده می‌شود و ذخیره نمی‌شود

پیش‌نیازها

سرور اصلی باید این پکیج‌ها را داشته باشد:

tinc
iproute2
net-tools
sshpass

پکیج‌های لازم روی سرورهای ریموت به صورت خودکار نصب می‌شوند.

نصب
```bash
bash <(wget -qO- https://raw.githubusercontent.com/aliabsharii/mesh-tunnel/main/tinc-mesh.sh)
```
مرحله ۱ — راه‌اندازی سرور اصلی

روی سرور اصلی اجرا کنید:

```bash
sudo ./tinc-mesh.sh init --net ali --name iranserver --pub YOUR_MAIN_PUBLIC_IP --priv 10.20.0.1 --mask 255.255.255.0
```
مرحله ۲ — اضافه کردن سرور جدید

فقط آی‌پی عمومی را وارد کنید:

```bash
sudo ./tinc-mesh.sh addq --net ali --pub NODE_PUBLIC_IP
```

اسکریپت:

پسورد SSH را می‌پرسد
نام هاست را تشخیص می‌دهد
یک آی‌پی داخلی آزاد اختصاص می‌دهد
Tinc را روی سرور ریموت نصب می‌کند
آن را به مش متصل می‌کند
و همه نودها را سینک می‌کند

اختیاری:

```bash
sudo ./tinc-mesh.sh addq --net ali --pub NODE_PUBLIC_IP --ssh-user root
```
مشاهده لیست نودها
```bash
sudo ./tinc-mesh.sh list --net ali
```
سینک مجدد شبکه
```bash
sudo ./tinc-mesh.sh push --net ali
```
حذف نود
```bash
sudo ./tinc-mesh.sh del --net ali --name NODE_NAME
```

این کار باعث می‌شود:

نود از شبکه حذف شود
تنظیمات آن از همه سرورها پاک شود
و Tinc از سرور ریموت حذف گردد

ریستارت شبکه
```bash
sudo ./tinc-mesh.sh restart --net ali
```
فایروال

این پورت را روی همه سرورها باز کنید:
```bash
ufw allow 655/udp
ufw allow 655/tcp
```
فایل وضعیت

اطلاعات شبکه اینجا ذخیره می‌شود:

/etc/tinc/mesh_state/<net>.nodes

پسوردها ذخیره نمی‌شوند.

کاربردها

تونل بین ایران و خارج
بک‌بون ریورس
شبکه چند سروری
لایه انتقال برای سیستم‌های پراکسی

هشدار

استفاده از این ابزار باید مطابق قوانین کشور و زیرساخت شما باشد.
