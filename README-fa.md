ุงุณฺฉุฑูพุช ุณุจฺฉ ู ุณุฑุน Tinc Mesh Tunnel

ุณุงุฎุช ฺฉ ุดุจฺฉู ุฎุตูุต ุจู ุณุฑูุฑูุง ุดูุง โ ุจุฏูู ูุงุฒ ุจู ูพูู

ุงู ฺูุ

tinc-mesh.sh ฺฉ ุงุณฺฉุฑูพุช bash ุณุจฺฉ ุงุณุช ฺฉู:

ุณุฑูุฑูุง ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ Tinc VPN ุจู ูู ูุชุตู ูโฺฉูุฏ
ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ฺฉ ุชููู ูุด ฺฉุงูู (Full Mesh) ุงุฌุงุฏ ูโฺฉูุฏ
ููุท ุจู ุขโูพ ุณุฑูุฑ + ูพุณูุฑุฏ SSH ูุงุฒ ุฏุงุฑุฏ
ููู ฺุฒ ุฑุง ุฑู ุณุฑูุฑูุง ุฑููุช ูุตุจ ู ุชูุธู ูโฺฉูุฏ
ููุฏูุง ุฑุง ููุดู ุณูฺฉ ูฺฏู ูโุฏุงุฑุฏ

ููุงุณุจ ุจุฑุง:

ุงุชุตุงู ุณุฑูุฑูุง ุงุฑุงู โ ุฎุงุฑุฌ
ุจฺฉโุจูู ุชููู ุฑูุฑุณ
ูุงู ุงูุชูุงู ุจุฑุง V2Ray / Xray
ูุณุฑุงุจ ุจู ฺูุฏ ููฺฉุดู

ูฺฺฏโูุง

ุจุฏูู ูุงุฒ ุจู ูพูู
ุงุถุงูู ฺฉุฑุฏู ููุฏ ุจุง ฺฉ ุฏุณุชูุฑ
ุงุฎุชุตุงุต ุฎูุฏฺฉุงุฑ ุขโูพ ุฏุงุฎู
ุณูฺฉ ฺฉุงูู ุจู ููู ููุฏูุง
KeepAlive ูุนุงู
ุชูุธู MTU (ุจุฑ ุฑู 1380)
ุฑูุน ูุดฺฉู PMTU ู MSS
ุญุฐู ฺฉุงูู ู ุชูุฒ ููุฏ
ูพุณูุฑุฏ ููุท ูพุฑุณุฏู ูโุดูุฏ ู ุฐุฎุฑู ููโุดูุฏ

ูพุดโูุงุฒูุง

ุณุฑูุฑ ุงุตู ุจุงุฏ ุงู ูพฺฉุฌโูุง ุฑุง ุฏุงุดุชู ุจุงุดุฏ:

tinc
iproute2
net-tools
sshpass

๐ฆ ูุตุจ ูพุดโูุงุฒูุง

ูุจู ุงุฒ ุงุฌุฑุง ุงุณฺฉุฑูพุชุ ุงู ูพฺฉุฌโูุง ุจุงุฏ ุฑู ุณุฑูุฑ ุงุตู ูุตุจ ุจุงุดูุฏ:
```bash
apt update
apt install -y tinc iproute2 net-tools sshpass
```
ูพฺฉุฌโูุง ูุงุฒู ุฑู ุณุฑูุฑูุง ุฑููุช ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ูุตุจ ูโุดููุฏ.

ูุตุจ
```bash
wget -O tinc-mesh.sh https://raw.githubusercontent.com/aliabsharii/mesh-tunnel/main/tinc-mesh.sh
chmod +x tinc-mesh.sh
```
ูุฑุญูู ฑ โ ุฑุงูโุงูุฏุงุฒ ุณุฑูุฑ ุงุตู

ุฑู ุณุฑูุฑ ุงุตู ุงุฌุฑุง ฺฉูุฏ:

```bash
sudo ./tinc-mesh.sh init --net ali --name iranserver --pub YOUR_MAIN_PUBLIC_IP --priv 10.20.0.1 --mask 255.255.255.0
```
ูุฑุญูู ฒ โ ุงุถุงูู ฺฉุฑุฏู ุณุฑูุฑ ุฌุฏุฏ

ููุท ุขโูพ ุนููู ุฑุง ูุงุฑุฏ ฺฉูุฏ:

```bash
sudo ./tinc-mesh.sh addq --net ali --pub NODE_PUBLIC_IP
```

ุงุณฺฉุฑูพุช:

ูพุณูุฑุฏ SSH ุฑุง ูโูพุฑุณุฏ
ูุงู ูุงุณุช ุฑุง ุชุดุฎุต ูโุฏูุฏ
ฺฉ ุขโูพ ุฏุงุฎู ุขุฒุงุฏ ุงุฎุชุตุงุต ูโุฏูุฏ
Tinc ุฑุง ุฑู ุณุฑูุฑ ุฑููุช ูุตุจ ูโฺฉูุฏ
ุขู ุฑุง ุจู ูุด ูุชุตู ูโฺฉูุฏ
ู ููู ููุฏูุง ุฑุง ุณูฺฉ ูโฺฉูุฏ

ุงุฎุชุงุฑ:

```bash
sudo ./tinc-mesh.sh addq --net ali --pub NODE_PUBLIC_IP --ssh-user root
```
ูุดุงูุฏู ูุณุช ููุฏูุง
```bash
sudo ./tinc-mesh.sh list --net ali
```
ุณูฺฉ ูุฌุฏุฏ ุดุจฺฉู
```bash
sudo ./tinc-mesh.sh push --net ali
```
ุญุฐู ููุฏ
```bash
sudo ./tinc-mesh.sh del --net ali --name NODE_NAME
```

ุงู ฺฉุงุฑ ุจุงุนุซ ูโุดูุฏ:

ููุฏ ุงุฒ ุดุจฺฉู ุญุฐู ุดูุฏ
ุชูุธูุงุช ุขู ุงุฒ ููู ุณุฑูุฑูุง ูพุงฺฉ ุดูุฏ
ู Tinc ุงุฒ ุณุฑูุฑ ุฑููุช ุญุฐู ฺฏุฑุฏุฏ

ุฑุณุชุงุฑุช ุดุจฺฉู
```bash
sudo ./tinc-mesh.sh restart --net ali
```
ูุงุฑูุงู

ุงู ูพูุฑุช ุฑุง ุฑู ููู ุณุฑูุฑูุง ุจุงุฒ ฺฉูุฏ:
```bash
ufw allow 655/udp
ufw allow 655/tcp
```
ูุงู ูุถุนุช

ุงุทูุงุนุงุช ุดุจฺฉู ุงูุฌุง ุฐุฎุฑู ูโุดูุฏ:

/etc/tinc/mesh_state/<net>.nodes

ูพุณูุฑุฏูุง ุฐุฎุฑู ููโุดููุฏ.

ฺฉุงุฑุจุฑุฏูุง

ุชููู ุจู ุงุฑุงู ู ุฎุงุฑุฌ
ุจฺฉโุจูู ุฑูุฑุณ
ุดุจฺฉู ฺูุฏ ุณุฑูุฑ
ูุงู ุงูุชูุงู ุจุฑุง ุณุณุชูโูุง ูพุฑุงฺฉุณ

ูุดุฏุงุฑ

ุงุณุชูุงุฏู ุงุฒ ุงู ุงุจุฒุงุฑ ุจุงุฏ ูุทุงุจู ููุงูู ฺฉุดูุฑ ู ุฒุฑุณุงุฎุช ุดูุง ุจุงุดุฏ.
